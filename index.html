<html>
<title>Infinity Miner</title>
<link rel="stylesheet" href="styles/main.css">
</link>
<link rel="stylesheet" href="styles/ore.css">
</link>

<body>
  <div id="container1"></div>
  <div id="container2"></div>
  <div id="container3"></div>
  <div id="container4"></div>
  <div id="container5"></div>
  <button id="mine" type="button" onclick="mine()">Mine</button>
  <div id="cooldown">cooldown: 5.0s</div>
  <div id="coin">0 Coin</div>
  <div id="crystal">0 Crystal</div>
  <button id="automine" onclick="automineswitch()">Auto<br><span id="automineswitch"
      style="font-size: small">OFF</span></button>
  <div id="ore">
    <div id="stone">Stone x0</div><button id="stonesell1" class="sell" type="button" onclick="stonesell1()">sell
      x1</button>
    <button id="stonesellmax" type="button" class="sell" onclick="stonesellmax()">sell max</button>
    <div id="copper">Copper x0</div><button id="coppersell1" class="sell" type="button" onclick="coppersell1()">sell
      x1</button>
    <button id="coppersellmax" type="button" class="sell" onclick="coppersellmax()">sell max</button>
    <div id="iron">Iron x0</div><button id="ironsell1" class="sell" type="button" onclick="ironsell1()">sell x1</button>
    <button id="ironsellmax" type="button" class="sell" onclick="ironsellmax()">sell max</button>
    <div id="silver">Silver x0</div><button id="silversell1" class="sell" type="button" onclick="silversell1()">sell
      x1</button>
    <button id="silversellmax" type="button" class="sell" onclick="silversellmax()">sell max</button>
    <div id="gold">Gold x0</div><button id="goldsell1" class="sell" type="button" onclick="goldsell1()">sell x1</button>
    <button id="goldsellmax" type="button" class="sell" onclick="goldsellmax()">sell max</button>
    <div id="platinum">Platinum x0</div><button id="platinumsell1" class="sell" type="button"
      onclick="platinumsell1()">sell x1</button>
    <button id="platinumsellmax" type="button" class="sell" onclick="platinumsellmax()">sell max</button>
    <div id="diamond">Diamond x0</div><button id="diamondsell1" class="sell" type="button" onclick="diamondsell1()">sell
      x1</button>
    <button id="diamondsellmax" type="button" class="sell" onclick="diamondsellmax()">sell max</button>
    <div id="emerald">Emerald x0</div><button id="emeraldsell1" class="sell" type="button" onclick="emeraldsell1()">sell
      x1</button>
    <button id="emeraldsellmax" type="button" class="sell" onclick="emeraldsellmax()">sell max</button>
    <div id="ruby">Ruby x0</div><button id="rubysell1" class="sell" type="button" onclick="rubysell1()">sell
      x1</button>
    <button id="rubysellmax" type="button" class="sell" onclick="rubysellmax()">sell max</button>
    <div id="sapphire">Sapphire x0</div>
    <div id="topaz">Topaz x0</div>
    <div id="obsidian">Obsidian x0</div>
  </div>
  <div id="pick">
    <div id="curpicklv">Wooden Pickaxe</div>
    <div id="picklvup" onclick="test()">Level up [ 0 / 2 Upgrades ]</div>
    <div id="stonepermine">1 ~ 2</div>
    <div id="pickupgrades">
      <div id="pickupgrade1" onclick="pickupgrade(0)">
        <div id="pickupgrade1detail" class="pickupgradedetail"></div>
        <div id="pickupgrade1price" class="pickupgradeprice"></div>
      </div>
      <div id="pickupgrade2" onclick="pickupgrade(1)">
        <div id="pickupgrade2detail" class="pickupgradedetail"></div>
        <div id="pickupgrade2price" class="pickupgradeprice"></div>
      </div>
      <div id="pickupgrade3" onclick="pickupgrade(2)">
        <div id="pickupgrade3detail" class="pickupgradedetail"></div>
        <div id="pickupgrade3price" class="pickupgradeprice"></div>
      </div>
      <div id="pickupgrade4" onclick="pickupgrade(3)">
        <div id="pickupgrade4detail" class="pickupgradedetail"></div>
        <div id="pickupgrade4price" class="pickupgradeprice"></div>
      </div>
      <div id="pickupgrade5" onclick="pickupgrade(4)">
        <div id="pickupgrade5detail" class="pickupgradedetail"></div>
        <div id="pickupgrade5price" class="pickupgradeprice"></div>
      </div>
    </div>
    <button id="coinupgrade" onclick="upgradeselect(0)">Coin</button>
    <button id="oreupgrade" onclick="upgradeselect(1)">Ore</button>
  </div>
  <div id="autominer">
    <div>
      <button id="autominerlocked" onclick="unlock()">Unlock Autominer<br>200 Iron</button>
    </div>
    <div>
      <div id="autominerselected" class="autominer">stone</div>
      <button id="autominertierup" class="autominer" onclick="tierup()"></button>
      <button id="autominerintervalup" class="autominer" onclick="intervalup()"></button>
      <button id="autominerpowerup" class="autominer" onclick="powerup()"></button>
      <button id="autominerselectleft" class="autominer" onclick="select(-1)">◀</button>
      <button id="autominerselectright" class="autominer" onclick="select(1)">▶</button>
    </div>
  </div>
  <div id="setting">
    <button id="notationchange" onclick="notationc()">Notation:<br><span id="notationname"
        style="font-size: small">Standard</span></button>
    <button id="save" onclick="save()">Save</button>
    <button id="load" onclick="load()">Load</button>
    <button id="export" onclick="exportdata()">Export</button>
    <button id="import" onclick="importdata()">Import</button>
    <button id="discord" onclick="window.open(`https://discord.gg/mcUPN5w`, `_blank`);">Discord</button>
    <button id="reset" onclick="reset()">Reset</button>
    <input type="text" id="selected" style="display: none"></input>
  </div>
  <div id="artifact">
    <div>
      <button id="artifactlocked" onclick="unlockartifact()">Unlock Artifact<br>5 Emerald</button>
    </div>
    <div id="commonbox" class="artifact box">Common Box x0</div><button id="commonboxopen" class="artifact box boxopen"
      onclick="openbox(0)">Open</button>
    <div id="uncommonbox" class="artifact box">Uncommon Box x0</div>
    <div id="rarebox" class="artifact box">Rare Box x0</div>
    <div id="epicbox" class="artifact box">Epic Box x0</div>
    <div id="legendbox" class="artifact box">Legendary Box x0</div>
    <div id="artifactlist1" class="artifact artifacts"></div>
    <button id="boxselect" class="artifact" onclick="artifactselect(0)">Box</button>
    <button id="artifactselect" class="artifact" onclick="artifactselect(1)">Artifact</button>
    <div id="artifacts1" class="artifact artifacts" onclick="artifactclick(1)">
      <span id="AFname1" style="color: #555; text-shadow: 0px 0px 10px #666">Improved Gear</span>
      <span id="AFrarity1" style="color: #fb5; text-shadow: 0px 0px 10px #c95">[common]</span>
      <div id="AFlevel1" style="color: #ddd; text-shadow: 0px 0px 10px #ddd; font-size: 2.1vmin">Lv. 0 / 30</div>
      <div id="AFdesc1" style="font-size: 1.9vmin; color: #444">Decrease Autominer Interval Limit</div>
    </div>
    <div id="artifacts2" class="artifact artifacts" onclick="artifactclick(2)">
      <span id="AFname2" style="color: #555; text-shadow: 0px 0px 10px #666">Improved Gear</span>
      <span id="AFrarity2" style="color: #fb5; text-shadow: 0px 0px 10px #c95">[common]</span>
      <div id="AFlevel2" style="color: #ddd; text-shadow: 0px 0px 10px #ddd; font-size: 2.1vmin">Lv. 0 / 30</div>
      <div id="AFdesc2" style="font-size: 1.9vmin; color: #444">Decrease Autominer Interval Limit</div>
    </div>
    <div id="artifacts3" class="artifact artifacts" onclick="artifactclick(3)">
      <span id="AFname3" style="color: #555; text-shadow: 0px 0px 10px #666">Improved Gear</span>
      <span id="AFrarity3" style="color: #fb5; text-shadow: 0px 0px 10px #c95">[common]</span>
      <div id="AFlevel3" style="color: #ddd; text-shadow: 0px 0px 10px #ddd; font-size: 2.1vmin">Lv. 0 / 30</div>
      <div id="AFdesc3" style="font-size: 1.9vmin; color: #444">Decrease Autominer Interval Limit</div>
    </div>
    <div id="artifacts4" class="artifact artifacts" onclick="artifactclick(4)">
      <span id="AFname4" style="color: #555; text-shadow: 0px 0px 10px #666">Improved Gear</span>
      <span id="AFrarity4" style="color: #fb5; text-shadow: 0px 0px 10px #c95">[common]</span>
      <div id="AFlevel4" style="color: #ddd; text-shadow: 0px 0px 10px #ddd; font-size: 2.1vmin">Lv. 0 / 30</div>
      <div id="AFdesc4" style="font-size: 1.9vmin; color: #444">Decrease Autominer Interval Limit</div>
    </div>
    <button id="artifactsleft" class="artifact artifacts" onclick="artifacttab(-1)">◀</button>
    <button id="artifactsright" class="artifact artifacts" onclick="artifacttab(1)">▶</button>

  </div>
  <div id="debug">
    <div class="debug" id="Stonegain" style="position: absolute; top: 2.5%; left: 39%; font-size: 1.6vmin">1 - 2</div>
    <div class="debug" id="Coppergain" style="position: absolute; top: 5.5%; left: 39%; font-size: 1.6vmin">1 - 2</div>
    <div class="debug" id="Irongain" style="position: absolute; top: 8.5%; left: 39%; font-size: 1.6vmin">1 - 2</div>
    <div class="debug" id="Silvergain" style="position: absolute; top: 11.5%; left: 39%; font-size: 1.6vmin">1 - 2</div>
    <div class="debug" id="Goldgain" style="position: absolute; top: 14.5%; left: 39%; font-size: 1.6vmin">1 - 2</div>
    <div class="debug" id="Platinumgain" style="position: absolute; top: 17.5%; left: 39%; font-size: 1.6vmin">1 - 2
    </div>
    <div class="debug" id="Diamondgain" style="position: absolute; top: 20.5%; left: 39%; font-size: 1.6vmin">1 - 2
    </div>
    <div class="debug" id="Emeraldgain" style="position: absolute; top: 23.5%; left: 39%; font-size: 1.6vmin">1 - 2
    </div>
    <div class="debug" id="Rubygain" style="position: absolute; top: 26.5%; left: 39%; font-size: 1.6vmin">1 - 2
    </div>
    <div class="debug" id="Boxgain" style="position: absolute; top: 2.5%; left: 47%; font-size: 1.6vmin">2%
    </div>
    <div class="debug" id="autominergaintick" style="position: absolute; top: 61%; left: 20%; font-size: 1.6vmin">10
      Stone / tick</div>
    <div class="debug" id="autominergainsec" style="position: absolute; top: 63%; left: 20%; font-size: 1.6vmin">10
      Stone / second</div>
  </div>

  <script src="javascript/variables.js"></script>
  <script src="javascript/upgrades.js"></script>
  <script src="javascript/loop.js"></script>
  <script src="javascript/data.js"></script>
  <script>
    window.addEventListener("keydown", (e) => {
      if (e.key == "F4") {
        if (debug == false) { debug = true }
        else { debug = false }
      }
    })
    function automineswitch() {
      if (automine == true) {
        automine = false
        document.getElementById("automine").style.backgroundColor = "#aaa"
        document.getElementById("automineswitch").innerHTML = "OFF"; return
      }
      automine = true
      document.getElementById("automine").style.backgroundColor = "#eea"
      document.getElementById("automineswitch").innerHTML = "ON"
    }
    function reset() {
      a = confirm("정말로 리셋하시겠습니까?");
      if (a) { localStorage.clear(); load() }
    }
    function upgradeselect(number) {
      selectedupgrade = number
    }
    function artifactselect(number) {
      selectedartifact = number
    }
    function artifactclick(number) {
      clickedartifact = number
      clicktimer = 50
    }
    function unlock() {
      if (autominerunlock == false && iron >= 200) {
        iron -= 200
        autominerunlock = true
      }
    }
    function tierup() {
      if (orelist[autominertier] >= tierupgprice[autominertier].split(" ")[0]) {
        if (autominertier == 1) {
          copper -= 3000
        }
        if (autominertier == 2) {
          iron -= 2000
        }
        if (autominertier == 3) {
          silver -= 1500
        }
        if (autominertier == 4) {
          gold -= 1750
        }
        if (autominertier == 5) {
          platinum -= 4000
        }
        if (autominertier == 6) {
          diamond -= 10000
        }
        autominertier++
      }
    }
    function intervalup() {
      if (intervalupgs >= 39) {
      intervale = 950
    } else { intervale = 900 }
    if (artifactstat[0]["level"] >= 1) {intervalLimit = 50 / (1.5 ** (artifactstat[0]["level"] + 1))}
    else {intervalLimit = 50}
    nextinterval = autominerinterval * intervale
      if (iron >= Math.floor(300 * (1.35 + 0.005 * intervalupgs) ** intervalupgs)) {
        if (3000 * (0.9 ** intervalupgs) > 50) {
          iron -= Math.floor(300 * (1.35 + 0.005 * intervalupgs) ** intervalupgs)
          intervalupgs++
        } else if (50 * (0.95 ** (intervalupgs - 39)) > intervalLimit) {
          iron -= Math.floor(300 * (1.35 + 0.005 * intervalupgs) ** intervalupgs)
          intervalupgs++
        }
      }
    }
    function powerup() {
      if (copper >= Math.floor(1000 * ((1.15 * (1.005 ** powerupgs)) ** powerupgs))) {
        copper -= Math.floor(1000 * ((1.15 * (1.005 ** powerupgs)) ** powerupgs))
        powerupgs++
      }
    }
    load()
    function isCommon(element) {
      if (element.rarity === 0) {
        return true;
      }
    }
    function isUncommon(element) {
      if (element.rarity === 1) {
        return true;
      }
    }
    function isRare(element) {
      if (element.rarity === 2) {
        return true;
      }
    }
    function isTrue(element) {
      if (element.level != 0) {
        return true;
      }
    }
    function openbox(number) {
      if (box[number] >= 1) {
        box[number] -= 1
        seed = random(1, 10000)
        if (seed <= 8000) {
          commons = artifactstat.filter(isCommon)
          seed2 = random(0, commons.length - 1)
          console.log(commons)
          artifactstat[artifactstat[seed2]["id"]]["level"] += 1
        } else if (seed <= 9500) {
          uncommons = artifactstat.filter(isUncommon)
          seed2 = random(1, uncommons.length)
          artifactstat[artifactstat[seed2]["id"]]["level"] += 1
        } else if (seed <= 10000) {
          rares = artifactstat.filter(isRare)
          seed2 = random(1, rares.length)
          artifactstat[artifactstat[seed2]["id"]]["level"] += 1
        }
      }
    }
    function select(number) {
      selectedore += number
      if (selectedore < 1) { selectedore = 1 }
      if (selectedore > autominertier) { selectedore = autominertier }
    }
    function random(a, b) {
      return Math.floor(Math.random() * (b - a + 1) + a)
    }
    function getore(ore) {
      if (ore[0] == 2) {
        return Math.floor((random(ore[2], ore[2] + ore[3]) * ((artifactstat[2]["level"] + 1) ** 1.4)) * crit)
      }
      else if (ore[0] == 1) {
        if (random(1, 100) < ore[1]) {
          return Math.floor(((artifactstat[2]["level"] + 1) ** 1.4) * crit)
        }
        else {
          return 0
        }
      }
      else if (ore[0] == 0) {
        return 0
      }
    }
    function getbox(number) {
      if (random(1, 100000) <= number && boxgain < 10) {
        box[0] += 1
        boxgain += 1
        console.log(boxgain)
      }
    }
    function mine() {
      if (curcooldown <= 0) {
        if (random(1, 100) <= artifactstat[1]["level"] * 2) {
          crit = Math.floor(30 * (1.4 ** (artifactstat[1]["level"] - 1))) / 10
          console.log(crit)
        } else { crit = 1 }
        if (automine == true) { curcooldown = Math.floor(5 * cooldown * ((artifactstat[2]["level"] + 1) ** 1.2)) } else { curcooldown = Math.floor(cooldown * ((artifactstat[2]["level"] + 1) ** 1.2)) }
        stone += getore(stonetype)
        copper += getore(coppertype)
        iron += getore(irontype)
        silver += getore(silvertype)
        gold += getore(goldtype)
        platinum += getore(platinumtype)
        diamond += getore(diamondtype)
        emerald += getore(emeraldtype)
        ruby += getore(rubytype)
        if (artifactunlock == true) {
          if (automine == true) {
            getbox(Math.floor((artifactstat[2]["level"] + 1) ** 1.4) * 200 / (2 ** boxgain))
          } else {
            getbox(Math.floor((artifactstat[2]["level"] + 1) ** 1.4) * 1000 / (2 ** boxgain))
          }
        }
        minecount += 1
      }
    }
    { // sell
      function stonesell1() {
        if (stone > 0) {
          stone -= 1
          coin += Math.floor(10 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function stonesellmax() {
        coin += Math.floor(stone * 10 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        stone = 0
      }
      function coppersell1() {
        if (copper > 0) {
          copper -= 1
          coin += Math.floor(100 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function coppersellmax() {
        coin += Math.floor(copper * 100 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        copper = 0
      }
      function ironsell1() {
        if (iron > 0) {
          iron -= 1
          coin += Math.floor(1300 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function ironsellmax() {
        coin += Math.floor(iron * 1300 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        iron = 0
      }
      function silversell1() {
        if (silver > 0) {
          silver -= 1
          coin += Math.floor(25000 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function silversellmax() {
        coin += Math.floor(silver * 25000 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        silver = 0
      }
      function goldsell1() {
        if (gold > 0) {
          gold -= 1
          coin += Math.floor(1e6 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function goldsellmax() {
        coin += Math.floor(gold * 1e6 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        gold = 0
      }
      function platinumsell1() {
        if (platinum > 0) {
          platinum -= 1
          coin += Math.floor(8e7 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function platinumsellmax() {
        coin += Math.floor(platinum * 8e7 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        platinum = 0
      }
      function diamondsell1() {
        if (diamond > 0) {
          diamond -= 1
          coin += Math.floor(2e10 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function diamondsellmax() {
        coin += Math.floor(diamond * 2e10 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        diamond = 0
      }
      function emeraldsell1() {
        if (emerald > 0) {
          emerald -= 1
          coin += Math.floor(5e13 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function emeraldsellmax() {
        coin += Math.floor(emerald * 5e13 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        emerald = 0
      }
      function rubysell1() {
        if (ruby > 0) {
          ruby -= 1
          coin += Math.floor(5e17 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        }
      }
      function rubysellmax() {
        coin += Math.floor(ruby * 5e17 * sellmult * (minecount ** (0.13 + (0.02 * artifactstat[4]["level"]))))
        ruby = 0
      }
    }
    function artifacttab(number) {
      if (artifactunlocked.length == 0) { console.log("no artifacts"); return }
      artifactpage += number
      if (artifactpage < 0) {
        artifactpage = 0
      }
      if (artifactpage > Math.floor((artifactunlocked.length - 1) / 4)) {
        artifactpage = Math.floor((artifactunlocked.length - 1) / 4)
      }
    }
    function logarithm(number) {
      if (number == 0) { return 0 }
      if (number == Infinity) { return "Infinity" }
      return "e" + Math.log10(number).toFixed(2)
    }
    function hexatrigesimal(number) {
      return number.toString(36)
    }
    function error(number) {
      a = 'E'
      a = a + String.fromCharCode(random(769, 878))
      a = a + 'R'
      a = a + String.fromCharCode(random(769, 878))
      a = a + 'R'
      a = a + String.fromCharCode(random(769, 878))
      a = a + 'O'
      a = a + String.fromCharCode(random(769, 878))
      a = a + 'R'
      a = a + String.fromCharCode(random(769, 878))
      return a
    }
    function letters(number) {
      standards = []
      for (j = 97; j < 123; j++) {
        standards.push(String.fromCharCode(j))
      }
      standardpointer = -1
      if (number == Infinity) { return "Infinity" }
      if (number < 1000) {
        return Math.floor(number)
      } else if (number < 1000 ** (standards.length - 1)) {
        returnnumber = number
        while (returnnumber >= 1000) {
          returnnumber /= 1000
          standardpointer += 1
        }
        result = String(returnnumber.toFixed(1)) + standards[standardpointer]
        return result
      } else {
        return scientific(number)
      }
    }
    function scientific(number) {
      if (number == Infinity) { return "Infinity" }
      if (number < 1000) {
        return Math.floor(number)
      } else {
        return number.toExponential(2).replace("+", "")
      }
    }
    function standard(number) {
      const standards = [' K', ' M', ' B', ' T', ' Qa', ' Qt', ' Sx', ' Sp', ' Oc', ' No', ' Dc', ' UDc', ' DDc', ' TDc', ' QaDc', ' QtDc', ' SxDc', ' SpDc', ' ODc', ' NDc', ' Vg', ' UVg', ' DVg', ' TVg', ' QaVg', ' QtVg', ' SxVg', ' SpVg', ' OVg', ' NVg', ' Tg']
      standardpointer = -1
      if (number == Infinity) { return "Infinity" }
      if (number < 1000) {
        return Math.floor(number)
      } else if (number < 1000 ** (standards.length - 1)) {
        returnnumber = number
        while (returnnumber >= 1000) {
          returnnumber /= 1000
          standardpointer += 1
        }
        result = String(returnnumber.toFixed(1)) + standards[standardpointer]
        return result
      } else {
        return scientific(number)
      }
    }
    function engineering(number) {
      standardpointer = 0
      if (number == Infinity) { return "Infinity" }
      if (number < 1000) {
        return Math.floor(number)
      } else if (number < 1000 ** (standards.length - 1)) {
        returnnumber = number
        while (returnnumber >= 1000) {
          returnnumber /= 1000
          standardpointer += 3
        }
        if (returnnumber > 100) {result = returnnumber.toFixed(1) + 'e' + standardpointer} else {result = returnnumber.toFixed(2) + 'e' + standardpointer}
        return result
      } else {
        return scientific(number)
      }
    }
    function unlockartifact() {
      if (emerald >= 5) {
        emerald -= 5
        artifactunlock = true
        box[0] += 1
      }
    }
    function notation(number) {
      if (notationsel == 0) return standard(number)
      if (notationsel == 1) return scientific(number)
      if (notationsel == 2) return engineering(number)
      if (notationsel == 3) return letters(number)
      if (notationsel == 4) return logarithm(number)
      if (notationsel == 5) return error(number)
    }
    function notationc() {
      notationsel += 1
      if (notationsel > 4) { notationsel = 0 }
    }
  </script>
</body>

</html>